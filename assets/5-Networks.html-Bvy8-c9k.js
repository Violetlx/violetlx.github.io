import{_ as a,c as t,b as n,o as p}from"./app-C7pp65Rl.js";const l="/assets/image-20230310210404548-CJVhUJOx.png",i="/assets/image-20230310211734469-B1ZDlEfN.png",e="/assets/image-20230310211848302-BduZ0ujz.png",m="/assets/image-20230310214914824-C2K9EzM_.png",r="/assets/image-20230310215206528-s7S6Wgs_.png",o="/assets/image-20230310215645399-BL0Sfxkt.png",c="/assets/image-20230311115506418-BYFaoehW.png",g="/assets/image-20230311140735509-CedVXoZX.png",h="/assets/image-20230311141045729-CDYxvOmS.png",d="/assets/image-20230311210056563-Dbh3jdSs.png",u={};function k(b,s){return p(),t("div",null,s[0]||(s[0]=[n('<p><img src="https://bizhi1.com/wp-content/uploads/2025/03/ghost-in-the-shell-motoko-kusanagi-cyberpunk-desktop-wallpaper.jpg" alt="攻壳机动队草薙素子赛博朋克桌面壁纸"></p><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">TIP</p><ul><li>数据交换</li><li>IP协议</li><li>路由算法与路由协议</li></ul></div><p>把分组数据从源端转发到目的端，实现分组交换网上的不同主机提供通信服务。</p><p>实现功能</p><ol><li>路由选择与分组转发</li><li>异构网络互联</li><li>拥塞控制（缓解网络阻塞，区别于链路层流量控制解决发送接收端速度不一致情况）</li></ol><h2 id="数据交换" tabindex="-1"><a class="header-anchor" href="#数据交换"><span><strong>数据交换</strong></span></a></h2><ul><li>电路：使用<strong>多路复用</strong>技术独占网络资源。<strong>通信时延小</strong>，有序传输，<strong>没有冲突</strong>，实时性强，建立连接时间长，网络使用效率低，灵活性差，<strong>无法差错控制（交换机只转发数据）</strong>。</li><li>报文：无需建立连接，<strong>具有存储转发，动态分配路线</strong>，线路利用率高，多目标服务。有存储转发时延，网络节点存储缓存交换</li><li>分组：同报文交换，需要额外的信息量，需要对分组排序存储 <ul><li>数据报方式：提供无连接服务（不确定分组传输的路径）</li><li>虚电路方式：提供连接服务（确定分组传播路径，类似于电路交换建立逻辑电路）</li><li><img src="'+l+'" alt="images/5-Networks/image-20230310210404548.png"></li></ul></li></ul><h2 id="ip协议" tabindex="-1"><a class="header-anchor" href="#ip协议"><span><strong>IP协议</strong></span></a></h2><p><img src="'+i+'" alt="images/5-Networks/image-20230310211734469.png"></p><p><img src="'+e+'" alt="images/5-Networks/image-20230310211848302.png"></p><ul><li>版本（IPV4、IPV6）</li><li>总长度（65525种数据）</li><li>生存时间TTL：IP报生存时间，经过一个路由减1，为0丢弃</li><li>协议：数据部分使用协议，TCP(6)，UDP(17)</li></ul><p><strong>IP数据报分片</strong></p><ul><li><p>标识：同一数据报的分片使用同一标识</p></li><li><p>标志：DF=1，禁止分片，DF=0，运行分片，MF=1：后续还有分片，MF=0代表最后一个分片</p></li><li><p>片偏移：原数据报相对位置（8B为单位），数据起始位置除以8等于片偏移</p></li></ul><p><strong>IP地址</strong>（32位/4字节标识符，网络号+主机号）</p><ul><li><p>分类IP地址</p><p><img src="'+m+'" alt="images/5-Networks/image-20230310214914824.png"></p></li><li><p>特殊IP地址</p><p><img src="'+r+'" alt="image-20230310215206528"></p><p><strong>私有地址</strong></p><p><img src="'+o+'" alt="image-20230310215645399"></p><table><thead><tr><th>网络类别</th><th>最大可用网号</th><th>第一可用网号</th><th>最后可用网号</th><th>最大主机数</th></tr></thead><tbody><tr><td>A(固定0)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>7</mn></msup></mrow><annotation encoding="application/x-tex">2^7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span> -2 =126</td><td>1</td><td>126</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^{24}-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></td></tr><tr><td>B(固定10)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>14</mn></msup></mrow><annotation encoding="application/x-tex">2^{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">14</span></span></span></span></span></span></span></span></span></span></span></span>-1</td><td>128.1</td><td>191.255</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^{16}-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></td></tr><tr><td>C(固定110)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>21</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{21}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></td><td>192.0.1</td><td>233.255.255</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^8-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>=254</td></tr></tbody></table></li></ul><p><strong>IP组播</strong> （多播） TODO</p><ul><li><p>单播（点对点方式）</p></li><li><p>广播</p></li><li><p>多播（效率最高）</p><blockquote><p>使用UDP协议</p><p>不产生ICMP报文</p><p>组播地址范围 224.0.0.0 ~ 239.255.255.255</p></blockquote></li></ul><p><strong>移动IP</strong>（使用固定IP，实现跨越不同网段的漫游功能，网络IP权限不会在漫游中发生改变）</p><ul><li>移动节点：具有永久IP地址的移动设备</li><li>归属代理（实际网络代理）</li></ul><p><strong>网络地址转换NAT</strong>（专用网络连接到互联网）</p><ul><li>宽带分享</li><li>安全防护</li></ul><p><strong>子网划分与子网掩码</strong></p><ul><li><p>子网结构：网络号+子网号+主机号</p></li><li><p>子网掩码：<strong>区分子网IP网络号与主机号界限</strong>（网络号位数全1，主机号位数全0）</p></li><li><p><img src="'+c+`" alt="image-20230311115506418"></p></li><li><p><strong>子网IP计算：通过子网掩码与外网IP逐位相与</strong></p></li><li><p>特殊网段IP与二进制表示</p><table><thead><tr><th>二进制表示</th><th>十进制表示</th></tr></thead><tbody><tr><td>10000000</td><td>128</td></tr><tr><td>11000000</td><td>192</td></tr><tr><td>11100000</td><td>224</td></tr><tr><td>11110000</td><td>240</td></tr><tr><td>11111000</td><td>248</td></tr><tr><td>11111100</td><td>252</td></tr><tr><td>11111110</td><td>254</td></tr><tr><td>11111111</td><td>255</td></tr></tbody></table></li></ul><p><strong>无分类编址CIDR</strong></p><ul><li><p>消除分类IP及划分子网概念</p></li><li><p>CIDR标记法：eg：128.14.35.7/20：前20位网络号</p><blockquote><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">二进制：  <span class="token number">10000000</span> 00001110 00100011 00000111 <span class="token punctuation">(</span><span class="token number">128.14</span>.35.7<span class="token punctuation">)</span></span>
<span class="line">最小地址: <span class="token number">10000000</span> 00001110 00100000 00000000 <span class="token punctuation">(</span><span class="token number">128.14</span>.32.0<span class="token punctuation">)</span></span>
<span class="line">最大地址: <span class="token number">10000000</span> 00001110 00100000 00000000 <span class="token punctuation">(</span><span class="token number">128.14</span>.47.255<span class="token punctuation">)</span></span>
<span class="line">地址掩码: <span class="token number">11111111</span> <span class="token number">11111111</span> <span class="token number">11110000</span> 00000000 <span class="token punctuation">(</span><span class="token number">255.255</span>.240.0<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote></li></ul><p><strong>构成超网：</strong> 将多个子网聚合成较大的子网（路由聚合）</p><ul><li>将相同位数和相同的网络号合并成一个路由（路由器记录下一跳地址）</li><li>查找路由时通过<strong>最长匹配网络号进行路由</strong></li></ul><p><strong>ARP协议</strong>（地址解析协议，建立IP地址与Mac地址映射）</p><ul><li><p>路由器广播ARP请求分组（广播询问IP对应的Mac地址）</p><p><img src="`+g+'" alt="images/5-Networks/image-20230311140735509.png"></p><p>单波ARP响应分组（返回本机IP地址及MAC地址给路由器）</p><p><img src="'+h+'" alt="images/5-Networks/image-20230311141045729.png"></p></li></ul><p><strong>DHCP协议</strong>（服务器向客户端动态分配IP，子网掩码，默认网关，DNS服务器）</p><p><em><strong>DHCP属于应用层协议，使用C/S方式，客户端和服务端广播进行交互，基于UDP</strong></em></p><ol><li>入网主机广播DHCP发现报文，寻找网络中DHCP服务器</li><li>服务器广播DHCP提供报文（服务拟分配主机一个IP地址及相关配置）</li><li>主机广播DHCP请求报文</li><li>服务器确定DHCP报文</li></ol><p><strong>ICMP协议</strong>（用于差错报告，网络探寻）</p><ul><li><p>差错报文</p><ol><li>终点不可达（路由器或主机不能交付分组到目的时，向源点发送不可达报文）</li><li>源点抑制（网络拥塞丢弃分组）</li><li>时间超过（分组中TTL为零）</li><li>参数问题（首部数据问题）</li><li>改变路由（重定向）</li></ol><hr><ul><li><p>一个报文只存在一个ICMP差错报文（一个分组出发后，后续所有分组都不发送）</p></li><li><p>对具有组播地址的数据不会发送ICMP差错报文</p></li><li><p>对ICMP差错报告报文不再发送ICMP差错报文</p></li><li><p>对特殊地址（127.0.0.1或0.0.0.0)不发送ICMP报文</p></li></ul></li><li><p>询问报文（测试目的站是否可达及了解相关状态）</p><ol><li>请求回答（ping）</li><li>本地时间错校验（用时钟同步测量连通时间，traceroute）</li><li>掩码地址请求回答</li><li>路由器询问和通告</li></ol></li></ul><h2 id="路由算法与路由协议" tabindex="-1"><a class="header-anchor" href="#路由算法与路由协议"><span><strong>路由算法与路由协议</strong></span></a></h2><ul><li><p>静态（手动配置，适用于结构简单，拓扑变化不大的网络中）</p></li><li><p>动态（自适应）</p><ul><li><p>内部网关协议</p><ol><li><p>RIP(距离向量)：路由器中维护从它到目的网络的最佳路径（<strong>最大15跳，UDP，应用层</strong>）</p><blockquote><p>仅和相邻的路由器交换信息（路由表）</p><p>每30秒交换一次路由信息，若超过180秒没接收到邻居路由信息，则判断邻居路由不可达，并更新自己路由表</p><p>经过多次交换后所有路由器将存储内网网络所有路由表</p><p><strong>距离向量算法</strong></p><ol><li>更改相邻路由RIP报文路由表所有表项（<strong>下一跳改为相邻路由地址，TTL加1</strong>）</li><li>更新本地路由表，存在相同的目的网络和相同的下跳网络（更新跳数），存在相同的目的网络则比较跳数（跳数较短的更新替代）</li><li>180s未收到邻居路由报文，则把邻居路由标记不可达，设置跳数为16</li></ol></blockquote></li><li><p>OSPF：最短路径优先</p><blockquote><p>路由器广播发送相邻的所有路由器链路信息（只有链路变化才发送）。</p><p>子网中所有路由器链路信息都交换完毕后使用Dijkstra算法依据链路状态构造最短路径</p></blockquote></li></ol></li><li><p>外部网络（BGP)：交换路基向量（应用协议，使用TCP传输）</p></li></ul><p><img src="'+d+'" alt="image-20230311210056563"></p></li><li><p><strong>路由器转发分组算法</strong></p><ol><li><p>提取目的地址IP</p></li><li><p>判断是否直接交付（<strong>目的IP与各个子网掩码相与操作，判断IP是否与相应的子网IP匹配</strong>，匹配则将IP转为Mac地址，并封装成Mac帧发送到目的主机</p></li><li><p>特定主机路由地址（路由器中存在目的地址的特殊路由）</p></li><li><p>检测路由表中是否存在合适路径**（目的地址与各网子掩码相与操作，判断IP网络号与子网网络号是否相同，相同则交付给子网路由下一条地址）**</p></li><li><p>默认路由地址（路由器传给下一路由地址，<strong>路由器默认网关</strong>）</p></li><li><p>报告转发分组出错</p></li></ol></li></ul>',36)]))}const w=a(u,[["render",k]]),x=JSON.parse('{"path":"/docs/Computer/Computer/2_Networks/5-Networks.html","title":"网络层","lang":"en-US","frontmatter":{"title":"网络层","date":"2025/07/04"},"headers":[{"level":2,"title":"数据交换","slug":"数据交换","link":"#数据交换","children":[]},{"level":2,"title":"IP协议","slug":"ip协议","link":"#ip协议","children":[]},{"level":2,"title":"路由算法与路由协议","slug":"路由算法与路由协议","link":"#路由算法与路由协议","children":[]}],"filePathRelative":"docs/Computer/Computer/2_Networks/5-Networks.md","git":{"createdTime":1751621258000,"updatedTime":1751621258000,"contributors":[{"name":"lixuan","email":"2789968443@qq.com","commits":1}]}}');export{w as comp,x as data};
